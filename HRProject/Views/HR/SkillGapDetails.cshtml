@model HRProject.Models.HRSkillGapDetailsViewModel

@{
    ViewData["Title"] = "Skill Gap Details";
}

<div class="container mt-4">
    <h1 class="mb-2">Skill Gap Details – @Model.CompetenceName</h1>

    <div class="alert alert-light border">
        <strong>Summary:</strong> @Model.SummaryMessage
    </div>

    <div class="row">
        <!-- Project Demand -->
        <div class="col-md-6">
            <h3>Project Demand</h3>

            @if (Model.ProjectDemand != null && Model.ProjectDemand.Any())
            {
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Project</th>
                            <th>Min Level</th>
                            <th>Min Years</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var p in Model.ProjectDemand)
                        {
                            <tr>
                                <td>@p.ProjectName</td>
                                <td>@p.MinLevel</td>
                                <td>@p.MinYears</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p class="text-muted">No projects require this competence right now.</p>
            }
        </div>

        <!-- Employee Supply -->
        <div class="col-md-6">
            <h3>Available Employees</h3>

            @if (Model.EmployeeSupply != null && Model.EmployeeSupply.Any())
            {
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Level</th>
                            <th>Years</th>
                            <th>Availability</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var e in Model.EmployeeSupply)
                        {
                            <tr>
                                <td>@(string.IsNullOrWhiteSpace(e.FullName) ? "-" : e.FullName)</td>
                                <td>@e.Email</td>
                                <td>@e.Level</td>
                                <td>@(e.YearsOfExperience.HasValue? e.YearsOfExperience.ToString() : "-")</td>
                                <td>@e.AvailabilityPercent%</td>
                                <td>
                                    <a asp-controller="UserCompetences"
                                       asp-action="Profile"
                                       asp-route-email="@e.Email"
                                       class="btn btn-sm btn-secondary">
                                        Profile
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p class="text-muted">No employees currently have this competence.</p>
            }
        </div>
    </div>

    <div class="mt-3">
        <a asp-controller="HR" asp-action="SkillGap" class="btn btn-secondary">
            Back to Skill Gap Overview
        </a>

        <a asp-controller="UserCompetences" asp-action="Assign" class="btn btn-primary ms-2">
            Assign Competence
        </a>
    </div>
</div>
